=====================================================================
AJPapps - Make new dir

Линда Кайе 2016-2018. Посвящается Ариэль
=====================================================================

Этот скрипт создаёт каталог с порядковым номером или датой-временем в названии. Таким образом все каталоги, имена для которых пока не придуманы, будут идти по порядку, и не нужно будет вспоминать, какое сегодня число или какой там номер был последним. Так же можно создать каталог с уникальным именем в виде GUID, только в нижнем регистре и без скобочек.

Примеры получаемых в итоге каталогов и используемые при этом параметры:

• 0010                                 ==> /Number
• 2016.09.12                           ==> /Date
• 2016.09.24-03                        ==> /Date /Number
• 11.33.28                             ==> /Time
• 23.45.15-06                          ==> /Time /Number
• 2016.04.02 18.33.55                  ==> /Date /Time
• 2017.11.22 06.12.01-03               ==> /Date /Time /Number
• e52ff1bc-c620-46e3-891b-5cb488750b25 ==> /Guid
• 4ab6c462-4928-4e8d-9afe-0e6cbd4ab131 ==> /Guid /Number

Скрипт принимает следующие параметры:

> MakeNewDir.WSF [/Number] [/Date] [/Time] [/Guid]
>                [/Digits:n] [/IgnoreTrail] [/Multi]
>                [/ReverseSearch] [BaseFolder]

• BaseFolder - это каталог, в котором будет создан новый каталог. Если этот параметр опущен, то будет использован текущий каталог (будьте внимательны при работе с сетевыми адресами).

• /Digits - количество цифр в номере от 0 до 10. Если параметр опущен или указан ноль, будет использовано значение по умолчанию: 4 для номера и 2 для даты/времени. При попытке найти свободное имя для нового каталога, скрипт будет учитывать это число. Так, если в этом параметре указано 3, то скрипт будет пробегаться от "000" до "999".

• /IgnoreTrail - заставляет скрипт пропускать каталоги с хвостиками. Например, скрипт пытается создать каталог "0010", а в папке есть каталог "0010 - Ariel". Скрипт посчитает, что каталог "0010" существует и пропустит его, перейдя к каталогу "0011".

• /Multi - указывает скрипту после создания каталога выводить запрос на создание ещё одного. Работает только в GUI версии (WScript.EXE).

• /ReverseSearch - указывает скрипту производить поиск свободного элемента в обратном порядке. Тоесть, если у нас есть каталоги 0000 и 0050, то без этого параметра скрипт создаст каталог 0001, а с этим параметром - 0051. При наличии этого параметра, с увеличением количества цифр в номере, увеличивается время поиска свободного элемента.

Скрипт работает в трёх режимах: создание каталога с номером, создание каталога с датой-временем и создание каталога с GUID.

Первый режим включается, когда указан параметр /Number, но отсутствуют параметры /Date и /Time. В этом режиме имя нового каталога выглядит примерно так: "0000". Номера начинаются с нуля.

Второй режим включается, если указаны параметры /Date, /Time или оба сразу. При этом, если параметр /Number указан, скрипт сначала попытается создать каталог с датой/временем в названии, а если такой уже существует, то попытается добавить в название номер. Так, если каталог "2013.10.11" существует, скрипт попытается создать каталог "2013.10.11-01" (номера начинаются с единицы). Если же параметр /Number не указан, скрипт просто выдаст сообщение об ошибке.

Третий редим включается, если указан параметр /Guid. При этом можно добавить параметр /Number, и поведение в таком случае будет таким же как во втором режиме, но GUID - уникальное число, и создание двух каталогов с одинаковым GUID теоретически не возможно.

Параметр /Guid не совместим с параметрами /Date и /Time.

У параметров есть псевдонимы:

> /N = /Number   /D = /Date     /T = /Time
> /G = /Guid     /C = /Digits   /IT = /IgnoreTrail
> /S = /Single

Название скрипта может показаться не сильно оригинальным, но появилось оно благодаря тому, что предыдущая версия скрипта (не релизилась) была представлена аж четырьмя файлами:

• MakeNewNumberDir.VBS
• MakeNewDateDir.VBS
• MakeNewTimeDir.VBS
• MakeNewDateTimeDir.VBS

А до этого вообще использовались два BAT файла с такими строками:

> MD %date:~-4%.%date:~-7,2%.%date:~-10,2%
> MD "%date:~-4%.%date:~-7,2%.%date:~-10,2% %time:~,2%.%time:~3,2%.%time:~6,2%"

История изменений
-----------------

• 23.09.2016
  Первая публичная версия ^^
  
• 3.07.2017
  [-] В Usage и везде было указано расширение файла VBS, тогда как на самом деле оно теперь - WSF.
  [+] Добавлен режим GUID.
  
• 28.02.2018
  [+] Оптимизирован алгоритм поиска свободных имён папок, в результате чего создание новой папки в каталоге, где уже есть тысяча папок, проходит гораздо быстрее.
  
• 25.11.2018
  [+] Убрала ReadMe из заголовка скрипта Main.VBS. Чтобы не было дублей.
  [+] Поправила ReadMe.TXT, в том числе исправила очепятку в лицензии.
  [+] Добавлен параметр /Multi, при наличии которого, после создания каталога, скрипт спрашивает, нужно ли создать ещё один.
  [+] Добавлен параметр /ReverseSearch, заставляющий скрипт искать свободный элемент в обратном порядке.

Маленький копирайт
------------------

1. Программа и исходный код распространяются бесплатно.
2. Вы имеете право распространять их на тех же условиях.
3. Вы не имеете права использовать имя автора после модификации исходного кода.
4. При этом желательно указывать ссылку на автора оригинальной версии исходного кода.
5. Вы не имеете права на платное распространение исходного кода, а также программных модулей, содержащих данный исходный код.
6. Программа и исходный код распространяются как есть. Автор не несёт ответственности за любые трагедии или несчастные случаи, вызванные использованием программы и исходного кода.
7. Для любого пункта данного соглашения может быть сделано исключение с разрешения автора программы.
8. По любым вопросам, связанным с данной программой, обращайтесь по адресу lindaoneesama@gmail.com